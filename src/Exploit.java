package src;

public class Exploit {
    public Exploit(String plain, String cipher) {


        int n=0;
        String str=new String();
        String[][] key=new String[1024][2];
        keyScheduler keyScheduler;
        for(int i=0;i<1024;i++){
//            str=Integer.toBinaryString(i << 10);
            str = String.format("%10s", Integer.toBinaryString(i)).replace(' ','0');
//            System.out.println(str);
            keyScheduler=new keyScheduler(str);
            key[i]=keyScheduler.getKeys();
//            System.out.println(i + " "+key[i][0]);
//            System.out.println(key[i][1]);

        }
//        S_DES sDes;
        String result = new String();
        boolean flag = false;
        System.out.println("输入明密文串：  PlainText = " + plain + "  CipherText = " + cipher);
        int j=1;
        for(int i=0;i<1024;i++){
//            sDes=new S_DES(plain, key[i], 1);
//            result = sDes.getResultCipher();
//            System.out.println(i + "--"+result);
            if(result.equals(cipher)){
                System.out.println("第 "+j +" 次暴力破解成功！");
                System.out.println("获得密钥： key1 = " + key[i][0] + "  key2 = " + key[i][1]);
                flag=true;
//                break; //挑战五不用
                j++;//挑战五
            }
        }
        if (flag==false){
            System.out.println("输入明密文串：  PlainText = " + plain + "  CipherText = " + cipher);
            System.out.println("暴力破解失败！明密文不对应！");
        }

    }
}
